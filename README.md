# Godot Game Core - Logger Module

[![Лицензия: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

**Godot Game Core Logger** — это гибкая и мощная C# библиотека логирования, разработанная для использования с Godot Engine. Она предоставляет расширенные возможности по сравнению со стандартным `GD.Print`, помогая вам лучше понимать и отлаживать ваши игровые проекты.

## Особенности

*   **Уровни логирования:** Поддержка стандартных уровней (`Debug`, `Info`, `Warning`, `Error`, `Critical`) для классификации важности сообщений.
*   **Категории логов:** Организуйте логи по функциональным областям вашего проекта (например, `Network`, `Physics`, `UI`, `AI`).
*   **Детальная информация о вызове:** Автоматическое определение файла, номера строки, имени метода, класса и пространства имен, откуда был сделан вызов лога.
*   **Информация о потоке:** Включение ID потока в каждое сообщение для упрощения отладки многопоточных приложений.
*   **Гибкое форматирование вывода:**
    *   Настраиваемый формат времени.
    *   Возможность отображения коротких или полных путей к файлам.
*   **Поддержка "синков" (Sinks):** Легко расширяемая архитектура для направления логов в различные места назначения. В комплекте идет синк для вывода в консоль Godot.
*   **Потокобезопасность для Godot:** Автоматическое использование `Callable.CallDeferred` при логировании из фоновых потоков для безопасного взаимодействия с API Godot.
*   **Оптимизация `Debug` логов:** Вызовы `Log.Debug()` полностью удаляются из релизных сборок благодаря атрибуту `[Conditional("LOGGER_DEBUG")]` (или `DEBUG`), обеспечивая нулевые накладные расходы.
*   **Удобный статический API:** Простой доступ к функциям логирования через статический класс `Log` (например, `Log.Info("Сообщение");`).
*   **Цветной вывод:** Возможность использования BBCode для цветного выделения логов разного уровня в консоли Godot (через `GD.PrintRich`).

## Преимущества

*   **Улучшенная отладка:** Быстро находите проблемы благодаря подробной и структурированной информации.
*   **Чистый и информативный вывод:** Избавьтесь от хаоса `GD.Print` и получите логи, которые легко читать и анализировать.
*   **Гибкость и расширяемость:** Адаптируйте систему логирования под нужды вашего проекта.
*   **Полный контроль:** Управляйте тем, какая информация логируется и как она отображается.

## Установка и Настройка

Библиотека `Godot Game Core Logger` предоставляется в виде набора исходных C# файлов. Вы можете интегрировать ее в свой Godot C# проект одним из следующих способов:

### Способ 1: Git Submodule (Рекомендуется)

Этот метод предпочтителен, так как он упрощает получение обновлений.

1.  Откройте терминал в корневой директории вашего Godot проекта.
2.  Создайте папку для сторонних библиотек, если ее еще нет (например, `ThirdParty`):
    ```bash
    mkdir ThirdParty
    ```
3.  Добавьте репозиторий как подмодуль:
    ```bash
    git submodule add https://github.com/Studio613/GGC_Logger.git ThirdParty/GGC_Logger
    ```

4.  **Интеграция с проектом (.csproj):**
    Откройте `.csproj` файл вашего Godot проекта и добавьте строки для включения исходных файлов логгера в компиляцию. Поместите их внутрь существующего тега `<ItemGroup>` или создайте новый:
    ```xml
    <ItemGroup>
      <Compile Include="ThirdParty/GGC_Logger/**/*.cs" />
    </ItemGroup>
    ```
    *Убедитесь, что путь в `Include` точно соответствует расположению `.cs` файлов логгера относительно вашего `.csproj` файла.*

5.  Для получения обновлений логгера в будущем, выполните в терминале:
    ```bash
    git submodule update --remote ThirdParty/GGC_Logger
    ```

### Способ 2: Копирование файлов вручную

1.  Перейдите на страницу репозитория: `https://github.com/Studio613/GGC_Logger`
2.  Нажмите на зеленую кнопку "Code" и выберите "Download ZIP".
3.  Распакуйте архив.
4.  Скопируйте папку, содержащую исходные файлы логгера (например, `src/Game.Core.Logger/` из репозитория), в ваш проект Godot (например, в `MyProject/scripts/Core/Logger/`).
5.  Godot должен автоматически обнаружить новые `.cs` файлы. Если нет, или если вы используете специфическую структуру, может потребоваться вручную добавить их в `.csproj` файл, аналогично Способу 1.

### Настройка логгера

1.  **Сервер Логгера:**
    Добавьте узел `Server.cs` в ваш проект. Рекомендуется добавить его как **AutoLoad (Синглтон)** в настройках проекта Godot (`Проект -> Настройки проекта -> AutoLoad`).

2.  **Символ компиляции (для Log.Debug):**
    Для корректной работы условной компиляции `Log.Debug()` (чтобы вызовы удалялись из релизных сборок), убедитесь, что символ `LOGGER_DEBUG` активен для ваших отладочных конфигураций сборки.
    ```xml
    <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
        <DefineConstants>...;LOGGER_DEBUG;</DefineConstants>
    </PropertyGroup>
    ```
3.  **Обязательно замените функцию _EnterTreeGame на _EnterTree в Server.cs**

## Пример использования

После установки и настройки, вы можете легко использовать логгер в любом C# скрипте вашего проекта:

```csharp
using Godot;

using Game.Core.Logger;

namespace Game.Logic
{
    public partial class Player : Node
    {
        public override void _Ready()
        {
            // По умолчанию категория будет Temp
            Log.Info("_Ready")

            var test = GetNode<Node>("Test");
            if (test == null)
            {
                Log.Warn("Node \"Test\" not found", ELogCategory.Player);
            }
        }

        public void TakeDamage(int amount)
        {
            Log.Info($"Игрок получил {amount} урона.", ELogCategory.Player);
            if (amount > 100)
            {
                Log.Info("Критический урон получен!", ELogCategory.Player);
            }
        }

        public override void _Process(double delta)
        {
            // Пример очень частого лога, который будет только в Debug-сборках
            Log.Debug($"Player position: {this.GlobalPosition}", ELogCategory.Temp);
        }
    }
}
```

## Конфигурация Сервера Логгера

Вы можете настроить поведение логгера через публичные поля узла `Game.Core.Logger.Server`. Это можно сделать, если узел добавлен на сцену и доступен через `GetNode()`, или изменив значения по умолчанию непосредственно в его коде перед тем, как он будет инициализирован (например, если он используется как AutoLoad).

*   **`IsEnabled` (bool):**
    *   Описание: Включает или выключает логирование глобально.
    *   По умолчанию: `true`

*   **`MinimumLogLevel` (ELogLevel):**
    *   Описание: Устанавливает минимальный уровень сообщений, которые будут обрабатываться и выводиться. Сообщения с уровнем ниже указанного будут проигнорированы.
    *   По умолчанию: `ELogLevel.Debug`

*   **`TimeFormat` (string):**
    *   Описание: Строка формата для отображения времени в логах, используемая `DateTime.ToString()`.
    *   По умолчанию: `"HH:mm:ss.fff"`

*   **`UseShortFilePath` (bool):**
    *   Описание: Если `true`, в логах будет отображаться только имя файла, из которого был сделан вызов. Если `false`, будет отображаться полный путь к файлу.
    *   По умолчанию: `true`

*   **`Sinks` (List<ISink>):**
    *   Описание: Список активных "синков" (обработчиков логов). Каждый синк отвечает за вывод логов в определенное место (например, консоль Godot, файл и т.д.). Вы можете добавлять или удалять синки из этого списка для кастомизации вывода.
    *   По умолчанию: Содержит один экземпляр `Game.Core.Logger.Sinks.Godot`.

## Вклад

Мы приветствуем ваш вклад в развитие Godot Game Core Logger! Если у вас есть идеи по улучшению, предложения новых функций или вы обнаружили ошибку, пожалуйста:

1.  **Создайте Issue:** Подробно опишите вашу идею или проблему на странице [Issues](https://github.com/Studio613/GGC_Logger/issues)
2.  **Для внесения кода:**
    *   Сделайте форк (Fork) этого репозитория.
    *   Создайте новую ветку для ваших изменений (`git checkout -b feature/ваша-фича` или `bugfix/описание-бага`).
    *   Внесите ваши изменения и сделайте коммиты.
    *   Отправьте Pull Request в основной репозиторий.

## Лицензия

Этот проект распространяется под лицензией MIT. Это означает, что вы можете свободно использовать, копировать, изменять, объединять, публиковать, распространять, сублицензировать и/или продавать копии Программного обеспечения.

Полный текст лицензии можно найти в файле `LICENSE` в корне этого репозитория.
